# âš¡ Jarvis ç”µå•†æ•°æ®ä¸­æ§

> ä¸€ä¸ªåŸºäº AI çš„ç”µå•†æ•°æ®åˆ†æç³»ç»Ÿï¼Œé‡‡ç”¨"é’¢é“ä¾ "é£æ ¼è®¾è®¡ï¼Œæ”¯æŒè‡ªç„¶è¯­è¨€æŸ¥è¯¢ã€ç”¨æˆ·æ™ºèƒ½åˆ†å±‚ã€é”€å”®é¢„æµ‹ç­‰åŠŸèƒ½ã€‚

![æ¶æ„](https://img.shields.io/badge/æ¶æ„-ä¸‰å±‚æ¶æ„-blue)
![Python](https://img.shields.io/badge/Python-3.9+-green)
![License](https://img.shields.io/badge/License-MIT-yellow)
![Streamlit](https://img.shields.io/badge/Streamlit-1.53+-red)

## ğŸ“– ç›®å½•

- [åŠŸèƒ½ç‰¹æ€§](#-åŠŸèƒ½ç‰¹æ€§)
- [ç³»ç»Ÿè¦æ±‚](#-ç³»ç»Ÿè¦æ±‚)
- [å¿«é€Ÿå¼€å§‹](#-å¿«é€Ÿå¼€å§‹)
- [é¡¹ç›®ç»“æ„](#-é¡¹ç›®ç»“æ„)
- [é…ç½®è¯´æ˜](#-é…ç½®è¯´æ˜)
- [API æ¥å£](#-api-æ¥å£)
- [ä½¿ç”¨ç¤ºä¾‹](#-ä½¿ç”¨ç¤ºä¾‹)
- [æŠ€æœ¯æ ˆ](#-æŠ€æœ¯æ ˆ)
- [å¼€å‘æŒ‡å—](#-å¼€å‘æŒ‡å—)
- [æ•…éšœæ’é™¤](#-æ•…éšœæ’é™¤)
- [è´¡çŒ®æŒ‡å—](#-è´¡çŒ®æŒ‡å—)

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ğŸ“Š æ•°æ®åˆ†æ
- **æ ¸å¿ƒKPIç›‘æ§**: GMVã€è®¢å•æ•°ã€é€€è´§ç‡ã€å®¢å•ä»·ã€å¤è´­ç‡
- **RFMç”¨æˆ·åˆ†å±‚**: ä½¿ç”¨K-Meansæ™ºèƒ½èšç±»ï¼Œè‡ªåŠ¨è¯†åˆ«é«˜ä»·å€¼å®¢æˆ·
- **æ¼æ–—åˆ†æ**: æµè§ˆâ†’åŠ è´­â†’ä¸‹å•â†’æ”¯ä»˜è½¬åŒ–ç‡åˆ†æ
- **é”€å”®é¢„æµ‹**: åŸºäºå†å²æ•°æ®çš„çº¿æ€§å›å½’é¢„æµ‹
- **å¤šç»´åº¦ç»Ÿè®¡**: æŒ‰å“ç±»ã€æ¸ é“ã€åŸå¸‚ç­‰ç»´åº¦åˆ†æ

### ğŸ¤– AI åŠ©æ‰‹ (Jarvis)
- **è‡ªç„¶è¯­è¨€æŸ¥è¯¢**: ç”¨ä¸­æ–‡æé—®ï¼Œè‡ªåŠ¨ç”ŸæˆSQLå¹¶è¿”å›ç»“æœ
- **æ•°æ®æ´å¯Ÿ**: AIè‡ªåŠ¨è§£è¯»æ•°æ®ï¼Œç»™å‡ºä¸šåŠ¡å»ºè®®
- **å¤šLLMæ”¯æŒ**: æ”¯æŒDeepSeekã€OpenAIã€Ollamaæœ¬åœ°æ¨¡å‹
- **æ¨¡æ‹Ÿæ¨¡å¼**: æ— éœ€API Keyå³å¯ä½“éªŒåŸºç¡€åŠŸèƒ½

### ğŸ¨ å¯è§†åŒ–
- **é’¢é“ä¾ é£æ ¼UI**: æ·±è‰²ç§‘æŠ€é£æ ¼ï¼Œéœ“è™¹å…‰æ•ˆ
- **3Dç”¨æˆ·åˆ†å¸ƒå›¾**: Plotly 3Dæ•£ç‚¹å›¾å±•ç¤ºRFMèšç±»
- **äº¤äº’å¼å›¾è¡¨**: æ”¯æŒç¼©æ”¾ã€æ‹–æ‹½ã€ç­›é€‰
- **å“åº”å¼è®¾è®¡**: é€‚é…ä¸åŒå±å¹•å°ºå¯¸

## ğŸ’» ç³»ç»Ÿè¦æ±‚

- **Python**: 3.9 æˆ–æ›´é«˜ç‰ˆæœ¬
- **æ“ä½œç³»ç»Ÿ**: Windows / macOS / Linux
- **å†…å­˜**: å»ºè®® 4GB ä»¥ä¸Š
- **ç£ç›˜ç©ºé—´**: è‡³å°‘ 500MB

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹å¼ä¸€ï¼šä½¿ç”¨è™šæ‹Ÿç¯å¢ƒï¼ˆæ¨èï¼‰

```bash
# 1. å…‹éš†æˆ–ä¸‹è½½é¡¹ç›®
cd dianshangshujufenxi

# 2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv .venv

# 3. æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
# Windows:
.venv\Scripts\activate
# macOS/Linux:
source .venv/bin/activate

# 4. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 5. å¯åŠ¨ Dashboard
python run.py dashboard
```

### æ–¹å¼äºŒï¼šç›´æ¥å®‰è£…

```bash
# 1. è¿›å…¥é¡¹ç›®ç›®å½•
cd dianshangshujufenxi

# 2. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 3. å¯åŠ¨ Dashboard
python run.py dashboard
```

### å¯åŠ¨é€‰é¡¹

```bash
# ä»…å¯åŠ¨ Dashboard (é»˜è®¤)
python run.py dashboard

# ä»…å¯åŠ¨ API æœåŠ¡
python run.py api

# åŒæ—¶å¯åŠ¨ Dashboard å’Œ API
python run.py both
```

### è®¿é—®åœ°å€

å¯åŠ¨æˆåŠŸåï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹åœ°å€è®¿é—®ï¼š

- **Dashboard**: http://localhost:8501
- **API æ–‡æ¡£**: http://localhost:8000/docs
- **API ç«¯ç‚¹**: http://localhost:8000/api

## ğŸ“ é¡¹ç›®ç»“æ„

```
dianshangshujufenxi/
â”œâ”€â”€ config.py              # å…¨å±€é…ç½®æ–‡ä»¶
â”œâ”€â”€ run.py                 # å¯åŠ¨è„šæœ¬
â”œâ”€â”€ dashboard.py           # Streamlit ä¸»ç•Œé¢
â”œâ”€â”€ requirements.txt       # Python ä¾èµ–
â”œâ”€â”€ README.md             # é¡¹ç›®æ–‡æ¡£
â”‚
â”œâ”€â”€ data/                  # æ•°æ®ç›®å½•ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”‚   â”œâ”€â”€ users.csv         # ç”¨æˆ·æ•°æ®
â”‚   â”œâ”€â”€ products.csv      # å•†å“æ•°æ®
â”‚   â”œâ”€â”€ orders.csv        # è®¢å•æ•°æ®
â”‚   â””â”€â”€ funnel.csv       # æ¼æ–—æ•°æ®
â”‚
â”œâ”€â”€ database/             # æ•°æ®åº“ç›®å½•ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”‚   â””â”€â”€ analytics.db     # DuckDB æ•°æ®åº“
â”‚
â”œâ”€â”€ core/                # æ ¸å¿ƒä¸šåŠ¡æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ data_manager.py   # æ•°æ®ç®¡ç† (ETL)
â”‚   â”œâ”€â”€ analyzer.py       # åˆ†æå¼•æ“
â”‚   â””â”€â”€ jarvis_agent.py  # AI åŠ©æ‰‹
â”‚
â”œâ”€â”€ api/                 # API æœåŠ¡æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ main.py         # FastAPI æœåŠ¡
â”‚
â””â”€â”€ utils/               # å·¥å…·æ¨¡å—
    â”œâ”€â”€ __init__.py
    â””â”€â”€ data_generator.py # æ•°æ®ç”Ÿæˆå™¨
```

## âš™ï¸ é…ç½®è¯´æ˜

### LLM é…ç½®

ç³»ç»Ÿæ”¯æŒä¸‰ç§ LLM æä¾›å•†ï¼Œå¯é€šè¿‡ç¯å¢ƒå˜é‡æˆ–ç›´æ¥ä¿®æ”¹ `config.py` é…ç½®ã€‚

#### DeepSeekï¼ˆæ¨èï¼‰

```bash
# Windows CMD
set DEEPSEEK_API_KEY=your_api_key_here
set LLM_PROVIDER=deepseek

# Windows PowerShell
$env:DEEPSEEK_API_KEY="your_api_key_here"
$env:LLM_PROVIDER="deepseek"

# macOS/Linux
export DEEPSEEK_API_KEY=your_api_key_here
export LLM_PROVIDER=deepseek
```

æˆ–åœ¨ `config.py` ä¸­ç›´æ¥é…ç½®ï¼š

```python
LLM_CONFIG = {
    "provider": "deepseek",
    "deepseek": {
        "api_key": "your_api_key_here",
        "base_url": "https://api.deepseek.com/v1",
        "model": "deepseek-chat",
    },
}
```

#### OpenAI

```bash
set OPENAI_API_KEY=your_api_key_here
set LLM_PROVIDER=openai
```

#### Ollamaï¼ˆæœ¬åœ°æ¨¡å‹ï¼‰

```bash
set LLM_PROVIDER=ollama
set OLLAMA_BASE_URL=http://localhost:11434
set OLLAMA_MODEL=llama3
```

### æ•°æ®é…ç½®

åœ¨ `config.py` ä¸­å¯ä»¥è°ƒæ•´æ•°æ®ç”Ÿæˆå‚æ•°ï¼š

```python
DATA_CONFIG = {
    "n_orders": 10000,        # è®¢å•æ•°é‡
    "n_users": 500,           # ç”¨æˆ·æ•°é‡
    "n_products": 200,        # å•†å“æ•°é‡
    "date_range_days": 180,   # æ•°æ®æ—¶é—´è·¨åº¦(å¤©)
    "refund_rate": 0.15,      # åŸºç¡€é€€è´§ç‡
}
```

### RFM åˆ†å±‚é…ç½®

```python
RFM_CONFIG = {
    "n_clusters": 4,  # èšç±»æ•°é‡
    "labels": {
        0: "é‡è¦ä»·å€¼å®¢æˆ·",
        1: "æ½œåŠ›å‘å±•å®¢æˆ·", 
        2: "ä¸€èˆ¬ç»´æŠ¤å®¢æˆ·",
        3: "æµå¤±é£é™©å®¢æˆ·",
    },
}
```

## ğŸ“– API æ¥å£

### æ ¸å¿ƒç«¯ç‚¹

| ç«¯ç‚¹ | æ–¹æ³• | è¯´æ˜ | å‚æ•° |
|------|------|------|------|
| `/api/kpi` | GET | è·å–æ ¸å¿ƒKPI | æ—  |
| `/api/rfm` | GET | RFMç”¨æˆ·åˆ†å±‚ | æ—  |
| `/api/funnel` | GET | æ¼æ–—åˆ†æ | æ—  |
| `/api/forecast` | GET | é”€å”®é¢„æµ‹ | `days` (é»˜è®¤7) |
| `/api/chat` | POST | AIå¯¹è¯ | `{"question": "é—®é¢˜"}` |
| `/api/stats/category` | GET | å“ç±»ç»Ÿè®¡ | æ—  |
| `/api/stats/channel` | GET | æ¸ é“ç»Ÿè®¡ | æ—  |
| `/api/stats/city` | GET | åŸå¸‚ç»Ÿè®¡ | æ—  |
| `/api/users/top` | GET | Topç”¨æˆ· | `limit` (é»˜è®¤10) |
| `/api/products/top` | GET | Topå•†å“ | `limit` (é»˜è®¤10) |

### API ç¤ºä¾‹

```python
import requests

BASE_URL = "http://localhost:8000"

# è·å– KPI
response = requests.get(f"{BASE_URL}/api/kpi")
kpi_data = response.json()
print(f"GMV: {kpi_data['gmv']}")

# RFM åˆ†æ
response = requests.get(f"{BASE_URL}/api/rfm")
rfm_data = response.json()
print(f"èšç±»æ•°é‡: {len(rfm_data['clusters'])}")

# AI å¯¹è¯
response = requests.post(
    f"{BASE_URL}/api/chat",
    json={"question": "æ‰¾å‡ºæ¶ˆè´¹æœ€é«˜çš„10ä¸ªç”¨æˆ·"}
)
result = response.json()
print(f"SQL: {result['sql']}")
print(f"æ•°æ®: {result['data']}")
print(f"æ´å¯Ÿ: {result['insight']}")
```

## ğŸ® ä½¿ç”¨ç¤ºä¾‹

### è‡ªç„¶è¯­è¨€æŸ¥è¯¢

åœ¨ Dashboard çš„ AI åŠ©æ‰‹åŒºåŸŸï¼Œå¯ä»¥ç›´æ¥ç”¨è‡ªç„¶è¯­è¨€æé—®ï¼š

```
"æ‰¾å‡ºæ¶ˆè´¹é‡‘é¢æœ€é«˜çš„å‰10åç”¨æˆ·"
"åˆ†æå„åŸå¸‚çš„é€€è´§ç‡"
"æœ€è¿‘ä¸€å‘¨çš„é”€å”®è¶‹åŠ¿å¦‚ä½•"
"å“ªä¸ªæ¸ é“çš„è½¬åŒ–æ•ˆæœæœ€å¥½"
"ç”µå­äº§å“ç±»ç›®çš„é”€å”®é¢æ˜¯å¤šå°‘"
"åŒ—äº¬å’Œä¸Šæµ·çš„GMVå¯¹æ¯”"
```

### å¿«æ·é—®é¢˜

ç³»ç»Ÿé¢„ç½®äº†å¸¸ç”¨å¿«æ·é—®é¢˜ï¼Œç‚¹å‡»å³å¯å¿«é€ŸæŸ¥è¯¢ï¼š
- æ¶ˆè´¹æœ€é«˜çš„ç”¨æˆ·
- å„å“ç±»é”€å”®æ’è¡Œ
- æ¸ é“è½¬åŒ–ç‡åˆ†æ
- åŸå¸‚é€€è´§ç‡å¯¹æ¯”

### æ•°æ®åˆ·æ–°

- **åˆ·æ–°æ•°æ®**: æ¸…é™¤ç¼“å­˜ï¼Œé‡æ–°åŠ è½½æ•°æ®
- **é‡æ–°ç”Ÿæˆæ•°æ®**: åˆ é™¤ç°æœ‰æ•°æ®ï¼Œç”Ÿæˆæ–°çš„æ¨¡æ‹Ÿæ•°æ®

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

| å±‚çº§ | æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|------|
| äº¤äº’å±‚ | Streamlit | 1.53+ | å¯è§†åŒ–å¤§å± |
| äº¤äº’å±‚ | Plotly | 5.18+ | äº¤äº’å¼å›¾è¡¨ |
| APIå±‚ | FastAPI | 0.104+ | REST API |
| APIå±‚ | Uvicorn | 0.24+ | ASGI æœåŠ¡å™¨ |
| AIå±‚ | LangChain | 0.1+ | LLM é›†æˆ |
| AIå±‚ | OpenAI SDK | 1.0+ | LLM æ¥å£ |
| è®¡ç®—å±‚ | Pandas | 2.0+ | æ•°æ®å¤„ç† |
| è®¡ç®—å±‚ | NumPy | 1.24+ | æ•°å€¼è®¡ç®— |
| è®¡ç®—å±‚ | Scikit-learn | 1.3+ | æœºå™¨å­¦ä¹  |
| æ•°æ®å±‚ | DuckDB | 0.9+ | åµŒå…¥å¼åˆ†ææ•°æ®åº“ |

## ğŸ‘¨â€ğŸ’» å¼€å‘æŒ‡å—

### æœ¬åœ°å¼€å‘

```bash
# 1. å…‹éš†é¡¹ç›®
git clone <repository-url>
cd dianshangshujufenxi

# 2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv .venv
source .venv/bin/activate  # Windows: .venv\Scripts\activate

# 3. å®‰è£…å¼€å‘ä¾èµ–
pip install -r requirements.txt

# 4. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
python run.py dashboard
```

### ä»£ç è§„èŒƒ

- éµå¾ª PEP 8 ä»£ç é£æ ¼
- æ‰€æœ‰å‡½æ•°å’Œç±»æ·»åŠ æ–‡æ¡£å­—ç¬¦ä¸²
- ä½¿ç”¨ç±»å‹æ³¨è§£æé«˜ä»£ç å¯è¯»æ€§
- åœ¨æ–‡ä»¶å¤´éƒ¨æ·»åŠ ä½œè€…ä¿¡æ¯

### æµ‹è¯•

```bash
# è¿è¡Œæµ‹è¯•ï¼ˆå¦‚æœæœ‰ï¼‰
python -m pytest tests/

# ä»£ç æ ¼å¼æ£€æŸ¥
black .
flake8 .
```

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**Q: å¯åŠ¨æ—¶æç¤º "LangChainæœªå®‰è£…"**

A: è™½ç„¶å·²å®‰è£… LangChainï¼Œä½†å¯èƒ½ç¼ºå°‘ç‰¹å®šç»„ä»¶ã€‚è¿è¡Œï¼š
```bash
pip install langchain langchain-community langchain-openai langchain-core
```

**Q: AI åŠŸèƒ½æ˜¾ç¤º "ä½¿ç”¨æ¨¡æ‹ŸLLMæ¨¡å¼"**

A: éœ€è¦é…ç½® LLM API Keyã€‚å‚è€ƒ [é…ç½®è¯´æ˜](#-é…ç½®è¯´æ˜) ç« èŠ‚ã€‚

**Q: æ•°æ®åº“è¿æ¥å¤±è´¥**

A: æ£€æŸ¥ `database/` ç›®å½•æ˜¯å¦å­˜åœ¨ï¼Œç¡®ä¿æœ‰å†™å…¥æƒé™ã€‚

**Q: Streamlit å¯åŠ¨å¤±è´¥**

A: ç¡®ä¿ç«¯å£ 8501 æœªè¢«å ç”¨ï¼Œæˆ–ä¿®æ”¹ `run.py` ä¸­çš„ç«¯å£å·ã€‚

**Q: å›¾è¡¨æ˜¾ç¤ºå¼‚å¸¸**

A: æ¸…é™¤æµè§ˆå™¨ç¼“å­˜æˆ–ä½¿ç”¨æ— ç—•æ¨¡å¼é‡è¯•ã€‚

### æ—¥å¿—æŸ¥çœ‹

Dashboard å’Œ API çš„è¿è¡Œæ—¥å¿—ä¼šè¾“å‡ºåˆ°ç»ˆç«¯ï¼ŒåŒ…å«ï¼š
- æ•°æ®åŠ è½½çŠ¶æ€
- LLM è¿æ¥çŠ¶æ€
- é”™è¯¯ä¿¡æ¯

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ä»£ç ï¼è¯·éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

### è´¡çŒ®ç±»å‹

- ğŸ› Bug ä¿®å¤
- âœ¨ æ–°åŠŸèƒ½
- ğŸ“ æ–‡æ¡£æ”¹è¿›
- ğŸ¨ ä»£ç ä¼˜åŒ–
- âš¡ æ€§èƒ½æå‡

## ğŸ“ License

æœ¬é¡¹ç›®é‡‡ç”¨ MIT License - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

## ğŸ‘¤ ä½œè€…

**é¾šçç„•** - [@gongdinghuan](https://github.com/gongdinghuan)

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®ï¼š

- [Streamlit](https://streamlit.io/) - æ•°æ®å¯è§†åŒ–æ¡†æ¶
- [FastAPI](https://fastapi.tiangolo.com/) - ç°ä»£åŒ– Web æ¡†æ¶
- [LangChain](https://langchain.com/) - LLM åº”ç”¨å¼€å‘æ¡†æ¶
- [Plotly](https://plotly.com/) - äº¤äº’å¼å›¾è¡¨åº“
- [DuckDB](https://duckdb.org/) - åµŒå…¥å¼åˆ†ææ•°æ®åº“

---

â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ª Starï¼
